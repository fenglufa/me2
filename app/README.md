# ME2 Flutter App

ME2 AI åˆ†èº«ç§»åŠ¨åº”ç”¨ - è®©ä½ çš„æ•°å­—ç”Ÿå‘½åœ¨å¦ä¸€ä¸ªä¸–ç•Œç”Ÿæ´»

## é¡¹ç›®ç»“æ„

```
lib/
â”œâ”€â”€ config/                    # å…¨å±€é…ç½®
â”‚   â””â”€â”€ app_config.dart       # API åœ°å€ã€è¶…æ—¶é…ç½®
â”œâ”€â”€ core/                      # æ ¸å¿ƒåŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â””â”€â”€ api_endpoints.dart # API ç«¯ç‚¹å¸¸é‡
â”‚   â”œâ”€â”€ network/
â”‚   â”‚   â”œâ”€â”€ dio_client.dart    # Dio å®¢æˆ·ç«¯å°è£…
â”‚   â”‚   â””â”€â”€ auth_interceptor.dart # è®¤è¯æ‹¦æˆªå™¨
â”‚   â”œâ”€â”€ storage/
â”‚   â”‚   â””â”€â”€ token_storage.dart # Token å®‰å…¨å­˜å‚¨
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ logger.dart        # æ—¥å¿—å·¥å…·
â”œâ”€â”€ modules/                   # åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ auth/                 # è®¤è¯æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ model/           # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ service/         # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ controller/      # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ view/            # UI é¡µé¢
â”‚   â”œâ”€â”€ home/                # é¦–é¡µï¼ˆåˆ†èº«åŠ¨æ€ï¼‰
â”‚   â”œâ”€â”€ avatar/              # åˆ†èº«æ¨¡å—ï¼ˆæ€§æ ¼ã€æ—¥è®°ã€æˆé•¿ï¼‰
â”‚   â”œâ”€â”€ world/               # ä¸–ç•Œæ¨¡å—ï¼ˆåŒºåŸŸã€åœºæ™¯ï¼‰
â”‚   â”œâ”€â”€ dialogue/            # å¯¹è¯æ¨¡å—ï¼ˆWebSocketï¼‰
â”‚   â””â”€â”€ profile/             # ä¸ªäººä¸­å¿ƒ
â”œâ”€â”€ router/
â”‚   â””â”€â”€ app_router.dart      # è·¯ç”±é…ç½®
â”œâ”€â”€ app.dart                  # App æ ¹ç»„ä»¶
â””â”€â”€ main.dart                 # å…¥å£æ–‡ä»¶
```

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Flutter 3.x
- **çŠ¶æ€ç®¡ç†**: Riverpod 2.x
- **ç½‘ç»œè¯·æ±‚**: Dio 5.x
- **ä»£ç ç”Ÿæˆ**: Retrofit + json_serializable
- **æœ¬åœ°å­˜å‚¨**: FlutterSecureStorage (Token) + SharedPreferences
- **è·¯ç”±**: go_router 12.x
- **WebSocket**: web_socket_channel
- **UI ç»„ä»¶**: fl_chart (å›¾è¡¨) + lottie (åŠ¨ç”») + cached_network_image

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
flutter pub get
```

### 2. ä»£ç ç”Ÿæˆ

```bash
flutter pub run build_runner build --delete-conflicting-outputs
```

### 3. è¿è¡Œåº”ç”¨

```bash
# iOS æ¨¡æ‹Ÿå™¨
flutter run

# Android æ¨¡æ‹Ÿå™¨
flutter run

# æŒ‡å®šè®¾å¤‡
flutter run -d <device_id>
```

### 4. æ„å»ºå‘å¸ƒç‰ˆæœ¬

```bash
# Android APK
flutter build apk --release

# iOS
flutter build ios --release
```

## API é…ç½®

å¼€å‘ç¯å¢ƒ API åœ°å€åœ¨ `lib/config/app_config.dart`:

```dart
static const String apiBaseUrl = 'http://localhost:8888';
```

ç”Ÿäº§ç¯å¢ƒéœ€ä¿®æ”¹ä¸ºå®é™…æœåŠ¡å™¨åœ°å€ã€‚

## æ ¸å¿ƒåŠŸèƒ½

### å·²å®ç° âœ…

- **é¡¹ç›®æ¶æ„**: æ¨¡å—åŒ–ç»“æ„ï¼Œç¬¦åˆå¼€å‘è§„èŒƒ
- **ç½‘ç»œå±‚**: Dio å®¢æˆ·ç«¯ + æ‹¦æˆªå™¨ + ç»Ÿä¸€é”™è¯¯å¤„ç†
- **è®¤è¯ç³»ç»Ÿ**:
  - æ‰‹æœºå· + éªŒè¯ç ç™»å½•
  - JWT Token è‡ªåŠ¨ç®¡ç†
  - Token å®‰å…¨å­˜å‚¨ï¼ˆFlutterSecureStorageï¼‰
- **è·¯ç”±ç³»ç»Ÿ**: go_router å£°æ˜å¼è·¯ç”±
- **çŠ¶æ€ç®¡ç†**: Riverpod Provider
- **æ—¥å¿—ç³»ç»Ÿ**: ç»Ÿä¸€æ—¥å¿—å·¥å…·

### å¾…å®ç° ğŸš§

#### Phase 1: æ ¸å¿ƒåŠŸèƒ½
- [ ] **é¦–é¡µ** - åˆ†èº«å®æ—¶åŠ¨æ€å±•ç¤º
  - åˆ†èº«å½“å‰çŠ¶æ€ï¼ˆæ•£æ­¥/çœ‹ä¹¦/æ—…è¡Œç­‰ï¼‰
  - åŠ¨ç”»æ•ˆæœ
  - åˆ†èº«ä¸»åŠ¨æ¶ˆæ¯
  - å¯¹è¯å…¥å£

- [ ] **åˆ†èº«æ¨¡å—** - äººæ ¼ä¸æˆé•¿
  - 6 ç»´æ€§æ ¼é›·è¾¾å›¾ï¼ˆwarmth, adventurous, social, creative, calm, energeticï¼‰
  - AI ç”Ÿæˆçš„åˆ†èº«æ—¥è®°
  - æˆé•¿èŠ‚ç‚¹å±•ç¤º
  - å…³ç³»é¢æ¿ï¼ˆä¿¡ä»»åº¦/äº²å¯†åº¦/å…±é¸£åº¦ï¼‰

- [ ] **å¯¹è¯åŠŸèƒ½** - WebSocket æµå¼å¯¹è¯
  - å®æ—¶å¯¹è¯
  - æµå¼æ˜¾ç¤º
  - ä¸Šä¸‹æ–‡ç®¡ç†

#### Phase 2: å®Œå–„åŠŸèƒ½
- [ ] **ä¸–ç•Œæ¨¡å—** - ç¬¬äºŒç©ºé—´
  - 4 ä¸ªåŒºåŸŸå¡ç‰‡ï¼ˆæ—¥å¸¸åŸå¸‚/è‡ªç„¶åŒºåŸŸ/ç¤¾äº¤å¹¿åœº/ç¥ç§˜åŒºåŸŸï¼‰
  - åœºæ™¯åˆ—è¡¨
  - åˆ†èº«ä½ç½®è¿½è¸ª
  - äº‹ä»¶æ—¶é—´çº¿

- [ ] **ç”¨æˆ·æ—¥è®°** - åŒå‘äº’åŠ¨
  - ç”¨æˆ·å†™æ—¥è®°
  - åˆ†èº«è‡ªåŠ¨å›åº”
  - æƒ…ç»ªåˆ†æ

- [ ] **ä¸ªäººä¸­å¿ƒ**
  - ç”¨æˆ·ä¿¡æ¯
  - è®¢é˜…çŠ¶æ€
  - è®¾ç½®

#### Phase 3: ä½“éªŒä¼˜åŒ–
- [ ] åŠ¨ç”»æ•ˆæœï¼ˆLottieï¼‰
- [ ] ç¦»çº¿ç¼“å­˜
- [ ] æ¨é€é€šçŸ¥
- [ ] é”™è¯¯å¤„ç†ä¼˜åŒ–

## å¼€å‘è§„èŒƒ

å‚è€ƒ `/docs/appå¼€å‘è§„èŒƒ.md`

### æ ¸å¿ƒåŸåˆ™
- **æ¨¡å—åŒ–**: æ¯ä¸ªæ¨¡å—åŒ…å« model/service/controller/view
- **å•ä¸€èŒè´£**: æ–‡ä»¶ â‰¤ 500 è¡Œï¼Œæ–¹æ³• â‰¤ 50 è¡Œ
- **ç»Ÿä¸€ç®¡ç†**:
  - æ‰€æœ‰ç½‘ç»œè¯·æ±‚é€šè¿‡ `DioClient`
  - æ‰€æœ‰æ—¥å¿—é€šè¿‡ `AppLogger`
  - æ‰€æœ‰å¸¸é‡åœ¨ `constants/`
- **çŠ¶æ€ç®¡ç†**: ä½¿ç”¨ Riverpodï¼Œé¿å…åœ¨ View å±‚å†™ä¸šåŠ¡é€»è¾‘
- **ä»£ç ç”Ÿæˆ**: JSON åºåˆ—åŒ–ä½¿ç”¨ json_serializable

## é¡¹ç›®æ–‡æ¡£

- `/docs/appå®ç°æ–¹æ¡ˆ.md` - è¯¦ç»†å®ç°æ–¹æ¡ˆ
- `/docs/appå¼€å‘è§„èŒƒ.md` - å¼€å‘è§„èŒƒ
- `/docs/äº§å“è®¾è®¡æ–‡æ¡£.md` - äº§å“è®¾è®¡
- `/docs/æœåŠ¡æ¶æ„è¯´æ˜.md` - åç«¯æ¶æ„

## å¸¸è§é—®é¢˜

### 1. ä»£ç ç”Ÿæˆå¤±è´¥
```bash
# æ¸…ç†åé‡æ–°ç”Ÿæˆ
flutter pub run build_runner clean
flutter pub run build_runner build --delete-conflicting-outputs
```

### 2. ä¾èµ–å†²çª
```bash
# æ›´æ–°ä¾èµ–
flutter pub upgrade
```

### 3. iOS æ„å»ºå¤±è´¥
```bash
cd ios
pod install
cd ..
flutter clean
flutter run
```
